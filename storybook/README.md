# Storybook for Reactive Leda

Витрина для библиотеки компонентов Reactive Leda - @korus/leda

## Запуск

Возможно 2 варианта запуска storybook (при помощи скриптов):
1. "npm run start" - запускает storybook в "живом" режиме. Все изменения в самом storybook или компонентах сразу отображаются на экране (HMR)
2. "npm run build" - скрипт выгружает storybook в статическое приложение в папку ./dist, которое запускается при помощи файла index.html

## Как добавить компонент в сторибук

- Создать папку с названием компонента в папке storybook/stоries/components. Также можно добавить раздел (подраздел) в
ИНФО. Для этого нужно добавить (файл .stories.js в storybook/stоries/info).
- В созданной папке создать подпапку Examples. В ней хранятся примеры использования компонента, которые отображаются
непосредственно в сторибуке
- Создать пример использования компонента в папке Examples. Пример пишется как обычный React-компонент. Например:

```
import React from 'react';
import { Block } from '@korus/leda';

export default class extends React.Component {
  render() {
    return (
      <Block box>
        Коммуникация, суммируя приведенные примеры, программирует медиавес. Антропосоциология непредвзято преобразует
        анализ зарубежного опыта. Представляется логичным, что сегмент рынка наиболее полно творит напряженный фирменный
        стиль. Гегельянство трогательно наивно.
      </Block>
    );
  }
}
```

- В папке с названием компонента создать Файл [название_компонента].stories.js. При запуске сторибук обрабатывает все
файлы *.stories.js лежащие в папке storybook/stоries.
- В созданном файле [название_компонента].stories.js необходимо импортировать исходник файла-компонента из библиотеки
используя лоадер raw-loader. Например, для компонента Input это будет выглядеть как:

```
import componentSrc from '!raw-loader!@korus/leda/dist/components/Input';
```

- Далее в этом файле необходимо импортировать исходники примеров из созданной ранее папки Examples. При этом также
должен использоваться лоадер raw-loader. Например, импорт примера для компонента Input с названием файла InputIcon.js:

```
import ExampleInputIconSrc from '!raw-loader!./Examples/InputIcon';
```

- Затем необходимо импортировать сами примеры из созданной папки Examples. Например, импорт может выглядеть следующим
образом:

```
import * as Examples from './Examples';
```

- Также в файле должны содержаться следующие импорты:

```
import React from 'react';
import { storiesOf } from '@storybook/react';  // основной метод формирования стори для компонента
import { withCustomInfo } from '../../lib';  // добавляет кастомную информацию к стори
```

- После импортов следует вызов метода storiesOf (технически этот метод возвращает React элемент). Первый аргумент -
название стори в виде строки (может иметь разделитель). Второй аргумент - 'module' (сторибуку нужна сслылка на
файл/модуль для HMR). Пример:

```
storiesOf('Компоненты|Input', module) { // Компоненты - раздел, Input - название стори, | - глобальный разделитель
...
}
```

- Далее к вызову метода storiesOf чейнится один или несколько методов add. Первый аргумент метода - название подраздела
стори в виде строки. Второй аргумент - функция, которая будет возвращать компонент (он будет отображен в виде примера в
сторибуке). Например:

```
storiesOf('Компоненты|Input', module)
  .add(
    'Input 1',
    () => {...}
  )
  .add(
    'Input 2',
    () => {...}
  )
```

- В качестве второго аргумента каждого вызова метода add должен быть вызов метода withCustomInfo (добавляет кастомную 
информацию к стори). Параметры withCustomInfo:

```
text: Описание компонента (тип: string)

source: Исходный код компонента, используется для парсинга свойств (тип: string). Сюда передается импортированный
при помощи лоадера raw-loader исходник файла-компонента.

code: исходный код примера, используется для отображения в стори кода примера (тип: string). Сюда передается
импортированный при помощи лоадера raw-loader пример компонента.

additionalInfo: дополнительная информация о компоненте (тип: React.Node)

Пример:

storiesOf('Компоненты|Input', module)
  .add(
    'Overview',
    withCustomInfo({
      text: 'Компонент для ввода значения на основе инпута',
      source: componentSrc,
      code: ExampleOverviewSrc,
    })(() => <ExampleOverview />),
  )
```

- Далее можно запустить сторибук при помощи скриптов start или bulid, новый стори автоматически появится в списке.
Также можно добавлять новые стори при запущенном скрипте start - сторибук поддерживает HMR, новый стори также
автоматически появится в списке компонентов.
